(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{295:function(t,s,a){t.exports=a.p+"assets/img/reset-pwd.8c11753b.png"},325:function(t,s,a){"use strict";a.r(s);var e=a(13),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"gitlab"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gitlab"}},[t._v("#")]),t._v(" GitLab")]),t._v(" "),s("h2",{attrs:{id:"安装部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装部署"}},[t._v("#")]),t._v(" 安装部署")]),t._v(" "),s("h3",{attrs:{id:"以docker-engine的方式安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#以docker-engine的方式安装"}},[t._v("#")]),t._v(" 以Docker Engine的方式安装")]),t._v(" "),s("ul",[s("li",[t._v("拉取gitlab-ee镜像")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull gitlab/gitlab-ee:lastest\n")])])]),s("ul",[s("li",[t._v("运行容器")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重点关注以下参数 --hostname -p")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run -d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --hostname "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.36 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -p "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(":443 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -p "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8021")]),t._v(":80 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -p "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8022")]),t._v(":22 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --name gitlab-ee "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --restart always "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /opt/env/docker/gitlab-ee/config:/etc/gitlab "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /opt/env/docker/gitlab-ee/logs:/var/log/gitlab "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /opt/env/docker/gitlab-ee/data:/var/opt/gitlab "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --shm-size 256m "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --privileged"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  gitlab/gitlab-ee\n")])])]),s("ul",[s("li",[t._v("配置gitlab")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/gitlab/gitlab.rb\n\nexternal_url "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://192.168.1.36'")]),t._v("\ngitlab_rails"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gitlab_ssh_host'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'192.168.1.36'")]),t._v("\ngitlab_rails"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gitlab_shell_ssh_port'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8022")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果内存不足时，则puma关闭，否则浏览器访问会出现502错误")]),t._v("\npuma"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'enable'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /var/opt/gitlab/gitlab-rails/etc/gitlab.yml\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改http的端口")]),t._v("\nproduction: "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("base\n  gitlab:\n    port: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8021")]),t._v("\n")])])]),s("h2",{attrs:{id:"gitlab使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gitlab使用"}},[t._v("#")]),t._v(" GitLab使用")]),t._v(" "),s("h3",{attrs:{id:"服务端常用指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务端常用指令"}},[t._v("#")]),t._v(" 服务端常用指令")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("gitlab-ctl start "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动所有 gitlab 组件")]),t._v("\ngitlab-ctl stop "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止所有 gitlab 组件")]),t._v("\ngitlab-ctl restart "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启所有 gitlab 组件")]),t._v("\ngitlab-ctl status "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看服务状态")]),t._v("\ngitlab-ctl reconfigure "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动服务")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/gitlab/gitlab.rb "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改默认的配置文件")]),t._v("\ngitlab-rake gitlab:check "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("SANITIZE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true --trace "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查gitlab")]),t._v("\ngitlab-ctl "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看日志")]),t._v("\n")])])]),s("h3",{attrs:{id:"用户-群组-项目管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户-群组-项目管理"}},[t._v("#")]),t._v(" 用户/群组/项目管理")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("新增用户可以通过超级管理员用户"),s("code",[t._v("root")]),t._v("进入"),s("code",[t._v("Admin Area")]),t._v("进行新增"),s("strong",[t._v("用户/群组/项目")])])]),t._v(" "),s("li",[s("p",[t._v("用户密码更改"),s("sup",[t._v("2")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("可以通过UI界面进行更改；")])]),t._v(" "),s("li",[s("p",[t._v("也可以通过服务端进行更改")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入Rails console")]),t._v("\ngitlab-rails console\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 三种方式查找用户")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. 通过用户名查找用户")]),t._v("\nuser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" User.find_by_username "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'exampleuser'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. 通过用户ID查找用户")]),t._v("\nuser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" User.find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3. 通过电子邮箱查找用户")]),t._v("\nuser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" User.find_by"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("email: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user@example.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重置密码")]),t._v("\nnew_password "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'examplepassword'")]),t._v("\nuser.password "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" new_password\nuser.password_confirmation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" new_password\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 保存用户信息")]),t._v("\nuser.save"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n")])])]),s("p",[s("img",{attrs:{src:a(295),alt:"重置密码"}})])])])])]),t._v(" "),s("h3",{attrs:{id:"用户配置-ssh配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户配置-ssh配置"}},[t._v("#")]),t._v(" 用户配置（SSH配置）")]),t._v(" "),s("p",[s("RouterLink",{attrs:{to:"/env_deploy/tool_cvs_git.html#配置-与github关联"}},[t._v("参考Github配置SSH Key")])],1),t._v(" "),s("h2",{attrs:{id:"gitlab团队合作2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gitlab团队合作2"}},[t._v("#")]),t._v(" GitLab团队合作"),s("sup",[t._v("2")])]),t._v(" "),s("h2",{attrs:{id:"参考文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[t._v("#")]),t._v(" 参考文档")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://docs.gitlab.com/ee/security/reset_user_password.html#reset-your-root-password",target:"_blank",rel:"noopener noreferrer"}},[t._v("重置密码"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.jianshu.com/p/95991a646f72",target:"_blank",rel:"noopener noreferrer"}},[t._v("Git+GitLab团队协作"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);